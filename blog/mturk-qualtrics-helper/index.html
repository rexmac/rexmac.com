<!DOCTYPE html><!--[if lt IE 7]> <html class="no-js lt-ie9 lt-ie8 lt-ie7"> <![endif]--><!--[if IE 7]> <html class="no-js lt-ie9 lt-ie8"> <![endif]--><!--[if IE 8]> <html class="no-js lt-ie9"> <![endif]--><!--[if gt IE 8]><!--> <html class="no-js"> <!--<![endif]--><head><meta charset="utf-8" /><meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1" /><title>MTurk-Qualtrics Helper - rexmac.com</title><meta name="author" content="Rex McConnell" /><meta name="description" content="Rex McConnell's place on the world-wide-web, with tutorials, notes, and ramblings on computer programming, web development, and other topics" /><meta name="viewport" content="width=device-width" /><meta property="og:title" content="MTurk-Qualtrics Helper - rexmac.com"><meta property="og:description" content="Rex McConnell's place on the world-wide-web, with tutorials, notes, and ramblings on computer programming, web development, and other topics"><link rel="stylesheet" href="/css/site.css?1511989715" /><script src="/js/libs/modernizr-2.6.2.min.js"></script><script>
  (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
  (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
  m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
  })(window,document,'script','//www.google-analytics.com/analytics.js','ga');
  ga('create', 'UA-26354182-1', 'rexmac.com');
  ga('send', 'pageview');
</script></head><body><pre id="binary-life"></pre><div role="navigation" class="navbar navbar-fixed-top"><div class="navbar-inner"><div class="container"><button type="button" class="btn btn-navbar" data-toggle="collapse" data-target=".nav-collapse"><span class="icon-bar"></span><span class="icon-bar"></span><span class="icon-bar"></span></button><div class="profile-image-flip pull-left"><div><div class="front face"><img src="/img/profile.photo.jpg" /></div><div class="back face"><img src="/img/profile.pixel.png" /></div></div></div><!-- Everything you want hidden at 940px or less, place within here --><div class="nav-collapse collapse"><ul class="nav"><li><a href="http://rexmac.com/"><i class="fa fa-home" aria-hidden="true"></i> Home</a></li><li><a href="http://rexmac.com/about">About Me</a></li><li><a href="http://blog.rexmac.com">Blog</a></li><li><a href="http://rexmac.com/projects">Projects</a></li><li><a href="#" class="contactme">Contact</a></li></ul><ul class="nav pull-right"><li><a href="#" id="light-switch" title="Toggle lights"><i class="fa fa-adjust" aria-hidden="true"></i><span class="visuallyhidden">Toggle lights</span></a></li></ul><ul class="nav social-media pull-right"><li><a href="http://twitter.com/_rexmac" title="Follow me on Twitter"><i class="fa fa-twitter" aria-hidden="true"></i><span class="visuallyhidden">Follow me on Twitter</span></a></li><li><a href="http://google.com/+RexMcConnell" title="Follow me on Google+"><i class="fa fa-google-plus" aria-hidden="true"></i><span class="visuallyhidden">Follow me on Google+</span></a></li><li><a href="http://github.com/rexmac" title="View my projects on GitHub"><i class="fa fa-github" aria-hidden="true"></i><span class="visuallyhidden">View my project son GitHub</span></a></li><li><a href="http://stackoverflow.com/users/624093/rexmac" title="View my StackOverflow profile"><i class="fa fa-stack-overflow" aria-hidden="true"></i><span class="visuallyhidden">View my StackOverflow profile</span></a></li><li><a href="http://rexmac.com/feed" title="nom nom? View my site's RSS feed"><i class="fa fa-rss" aria-hidden="true"></i><span class="visuallyhidden">nom nom? View my site's RSS feed</span></a></li></ul></div></div></div></div><!--[if lt IE 7]><div class="browsehappy alert alert-error"><strong>Warning!</strong> You are using an <strong>outdated</strong> browser. Please <a href="http://browsehappy.com/">upgrade your browser</a> to improve your experience of this site.</div><![endif]--><div class="container wrapper"><div class="row"><div role="main" class="span8"><div class="post"><div class="page-header"><time datetime="2011-05-21T04:07:32Z"><span><span class="month">May</span><span class="day">21</span></span><span class="year">2011</span></time><h1>MTurk-Qualtrics Helper</h1><h5>Posted on May 21, 2011 @ 04:07 GMT in <a href="http://blog.rexmac.com/category/projects">Projects</a></h5><hr /></div><div class="content"><h4 id="background">Background</h4><p>Recently, my fiancée was investigating the use of <a href="http://www.mturk.com/">Amazon Mechanical Turk</a> (AMT) as a means of paying people for participating in her latest empirical research. The study involves taking an online survey that she created at <a href="http://www.qualtrics.com/">Qualtrics.com</a>(her University has an account).</p><h4 id="the-problem">The Problem</h4><p>AMT has a built-in feature for creating surveys. Unfortunately, it is rather limited in its implementation:</p><ul><li>There are no options for customizing the structure of surveys (e.g. multiple pages, order of presentation, etc.)</li><li>Customizing the look and feel requires knowledge of <abbr title="HypeyText Markup Language">HTML</abbr> and <abbr title="Cascading Style Sheets">CSS</abbr>. Skills that my fiancée and many others in her position do not possess.</li></ul><p>If you are creating a very simple survey with no more than a few questions, and if you are not terribly concerned about the survey’s appearance, then the built-in survey feature of AMT is probably the best option for you. But if you want a more complex survey and more control over its presentation, then you may be better off choosing from one of the various providers of web-based survey software.</p><p>Unfortunately, AMT’s web interface does not seem to allow for creating <a href="https://www.mturk.com/mturk/welcome?variant=worker">HIT</a>s that redirect the user to an external website. It was at this point that my fiancée asked me to look into the issue to see if there was a possible “programming” solution to the problem.</p><h4 id="preparation">Preparation</h4><p>My first stop was the <a href="https://requestersandbox.mturk.com/">AMT requester sandbox site</a> where I created a developer account. I then ent through the same procedure on the <a href="https://workersandbox.mturk.com/">AMT worker sandbox site</a>. I now had access to the AMT sandbox as both a requester and a worker, which allowed me to create and test my own HITs.</p><h4 id="easy-solution">Easy Solution?</h4><p>First, I examined the “Design” section of the AMT requester site. I chose to work with the “Blank Template”, which proved to be the exact opposite of what its name implies. After removing the contents of the “blank” template, my first thought was to just insert an <code>&lt;iframe&gt;</code> and point it to the URL of my fiancée’s survey.</p><p><code>&lt;iframe width="100%" height="100%" src="YOUR_URL_HERE"&gt;&lt;/iframe&gt;</code></p><p>Unfortunately, this solution has several major flaws. First, AMT’s web interface requires that your HIT template contain at least one question, i.e. an <code>&lt;input&gt;</code> element with a name prefixed with “Q1”. Adding an <code>&lt;input&gt;</code>element of type “hidden” satisfies this requirement, but it also leads to the next problem. Now that the survey meets the requirement of having at least one “question”, AMT inserts a “Submit” button at the bottom of the frame. The idea is that the user answers your “question” and then clicks the “Submit” button to claim their reward. In our scenario, the “question” that we want the user to answer is the survey in the <code>iframe</code>. However, there is no obvious way of preventing the user from clicking the “Submit” button before completing the survey. In other words, there is no way to prevent the user from getting paid for doing nothing! <em>Author’s note: If you know of a method to prevent this from happening, please let me know</em>.</p><h4 id="programming-solution">“Programming” Solution</h4><p>I did some digging around in the <a href="https://requestersandbox.mturk.com/developer">AMT developer resources</a>, and I discovered that, through the MTurk <abbr title="Application Programming Interface">API</abbr>, it was possible to create an “External HIT”, which loads a specified URL as the contents of a HIT. Creating an external HIT has a major advantage over the previous solution in that it causes the “Submit” button to be disabled. Therefore, the user can not submit the HIT and get credit for doing nothing! Of course, after the user has completed the survey, they deserve to get paid, at which point we want to enable that button. To do so, we must send a signal to AMT when the survey is over. When, AMT loads the survey URL, there are three parameters appended to the URL’s query string: <code>assignmentId</code>, <code>hitdId</code>, and <code>workerId</code>. To signal AMT that the survey has been completed and to allow the worker to claim their reward, we must send a GET or POST request to <code>https://www.mturk.com/mturk/externablSubmit</code> that contains the same three parameters. Easy enough. Except, how do we determine when we’re at the end of the survey?</p><p>I started looking at Qualtrics.com next. I didn’t have access to my fiancée’s university’s account, so I just worked with a free trial account. I created a survey with a few silly questions and got a feel for the Qualtrics.com web interface. Next, I looked at the help section of their site, and I was pleased to discover that they allow for embedding <abbr title="HypeyText Markup Language">HTML</abbr> code into the header or footer of surveys. More importantly, you can embed Javascript! They also use a version of the <a href="http://www.prototypejs.org/">Prototype</a> library in their survey pages which is great, but it took some getting used to as I have not used it in quite some time. Knowing that I can insert Javascript into the survey, I began looking for an event or a DOM element or attribute that I could use to test if the survey was completed or not. Turns out, Qualtrics has created just such an event. I decided to override their event handler, <code>Qualtrics.SurveyEngine.OnEndOfSurvey</code>, with my own function that signals AMT that the survey has been completed. I accomplished this by creating an invisible <code>&lt;iframe&gt;</code> that loads AMT’s external submit URL. In order to carry over the three query string parameters from AMT all the way to the end of the survey, I inserted some Javascript to extract each of the parameters’ values from the URL query string and insert them as hidden <code>&lt;input&gt;</code> elements. This allowed me to extract the values at the end of the survey. It also has the side benefit of including those values in the survey data allowing the surveyor to compare them to the values reported by AMT.</p><p>After I was done testing, I created a simple little <a href="http://rexmac.com/mturk">web application</a> to assist in the process of making external HITs on AMT for use with Qualtrics.com surveys. It provides the JavaScript to be inserted into the survey along with some helpful guidance on how to do just that, but the meat of the app is the form that allows for the quick creation of external HITs.</p><p>It was at this point that I realized there was another problem. Prior to accepting a HIT, an AMT worker sees a “preview” of the HIT, which in the case of an external HIT, is exactly the same thing they will see for a non-preview. In other words, AMT loads your survey URL on the preview page and does nothing to prevent the user from interacting with it. While there is nothing wrong with letting the user preview the actual survey, an inexperienced AMT worker may begin answering the survey without realizing that they have not yet accepted the HIT. Then, after completing the survey they will be unable to submit. I decided to try and solve this by adding some more Javascript to the survey header that would dim the frame and prevent clicking within the frame when the survey was being viewed as a preview. So far, I have tried three different methods of detecting when a survey is being previewed. All three methods have worked for me and my free trial account survey, but none of the methods have worked for my fiancée’s surveys on a paid account. I have an idea for a fourth method that should work in all conditions, but I have not yet implemented it.</p><p>All code is available on <a href="http://github.com/rexmac/MTurk-Qualtrics-Helper/">github</a>.</p></div><hr /><div class="tags">Tagged with <div class="tags-list"><a href="http://blog.rexmac.com/tag/mturk"><span class="label">mturk</span></a><a href="http://blog.rexmac.com/tag/qualtrics"><span class="label">qualtrics</span></a><a href="http://blog.rexmac.com/tag/amazon"><span class="label">amazon</span></a></div></div><div class="next-prev-nav"><a href="/blog/jekyll-power" rel="next" title="Jekyll Power">Jekyll Power</a>&nbsp;&raquo; </div></div></div><div id="sidebar" class="span4"><div class="sidebar-inner"><div class="sidebar-module latest-posts"><h3><i class="fa fa-clock-o"></i><span>Latest Posts</span></h3><h4><a href="/blog/fun-with-css3-backgrounds">Fun with CSS3 Backgrounds</a></h4><h6>April 04, 2013 @ 13:22 GMT</h6><h4><a href="/blog/virtualbox-host-only-adater-for-ubuntu-vm">VirtualBox Host-only Adater for Ubuntu VM</a></h4><h6>February 25, 2013 @ 13:17 GMT</h6><h4><a href="/blog/openswan-patch-for-android-ics-bug">Openswan Patch for Android ICS Bug</a></h4><h6>September 07, 2012 @ 16:22 GMT</h6><h4><a href="/blog/internet-security-when-travelling">Internet Security When Travelling</a></h4><h6>September 07, 2012 @ 16:22 GMT</h6><h4><a href="/blog/jekyll-power">Jekyll Power</a></h4><h6>September 01, 2012 @ 12:03 GMT</h6></div><div class="sidebar-module tag-cloud"><h3><i class="fa fa-tags"></i><span>Tag Cloud</span></h3><div class="tag-cloud-tags"><span style="font-size: 75%"><a href="http://blog.rexmac.com/tag/amazon/" title="1 post">amazon</a></span>&nbsp; <span style="font-size: 280%"><a href="http://blog.rexmac.com/tag/aws/" title="2 posts">aws</a></span>&nbsp; <span style="font-size: 75%"><a href="http://blog.rexmac.com/tag/background/" title="1 post">background</a></span>&nbsp; <span style="font-size: 75%"><a href="http://blog.rexmac.com/tag/bootstrap/" title="1 post">bootstrap</a></span>&nbsp; <span style="font-size: 75%"><a href="http://blog.rexmac.com/tag/css/" title="1 post">css</a></span>&nbsp; <span style="font-size: 75%"><a href="http://blog.rexmac.com/tag/css3/" title="1 post">css3</a></span>&nbsp; <span style="font-size: 280%"><a href="http://blog.rexmac.com/tag/ec2/" title="2 posts">ec2</a></span>&nbsp; <span style="font-size: 75%"><a href="http://blog.rexmac.com/tag/gradient/" title="1 post">gradient</a></span>&nbsp; <span style="font-size: 75%"><a href="http://blog.rexmac.com/tag/jekyll/" title="1 post">jekyll</a></span>&nbsp; <span style="font-size: 75%"><a href="http://blog.rexmac.com/tag/mturk/" title="1 post">mturk</a></span>&nbsp; <span style="font-size: 75%"><a href="http://blog.rexmac.com/tag/networking/" title="1 post">networking</a></span>&nbsp; <span style="font-size: 75%"><a href="http://blog.rexmac.com/tag/qualtrics/" title="1 post">qualtrics</a></span>&nbsp; <span style="font-size: 75%"><a href="http://blog.rexmac.com/tag/ruby/" title="1 post">ruby</a></span>&nbsp; <span style="font-size: 280%"><a href="http://blog.rexmac.com/tag/security/" title="2 posts">security</a></span>&nbsp; <span style="font-size: 75%"><a href="http://blog.rexmac.com/tag/travel/" title="1 post">travel</a></span>&nbsp; <span style="font-size: 75%"><a href="http://blog.rexmac.com/tag/ubuntu/" title="1 post">ubuntu</a></span>&nbsp; <span style="font-size: 75%"><a href="http://blog.rexmac.com/tag/virtualbox/" title="1 post">virtualbox</a></span>&nbsp; <span style="font-size: 75%"><a href="http://blog.rexmac.com/tag/vm/" title="1 post">vm</a></span>&nbsp; <span style="font-size: 280%"><a href="http://blog.rexmac.com/tag/vpn/" title="2 posts">vpn</a></span>&nbsp; </div></div><div class="sidebar-module categories"><h3><i class="fa fa-list"></i><span>Categories</span></h3><a href="http://blog.rexmac.com/category/security"><strong>security</strong></a> (2)<br /><a href="http://blog.rexmac.com/category/lyfebites"><strong>lyfebites</strong></a> (2)<br /><a href="http://blog.rexmac.com/category/projects"><strong>projects</strong></a> (1)<br /><a href="http://blog.rexmac.com/category/web-development"><strong>web development</strong></a> (1)<br /></div><div class="sidebar-module archives"><h3><i class="fa fa-briefcase"></i><span>Archives</span></h3><a href="http://blog.rexmac.com/2013/04"><strong>April 2013</strong></a> (1)<br /><a href="http://blog.rexmac.com/2013/02"><strong>February 2013</strong></a> (1)<br /><a href="http://blog.rexmac.com/2012/09"><strong>September 2012</strong></a> (3)<br /><a href="http://blog.rexmac.com/2011/05"><strong>May 2011</strong></a> (1)<br /></div></div></div></div><footer><div class="row"><div class="span8"><p>© 2017 Rex McConnell. Please read <a href="http://rexmac.com/license">the license page</a> for details about the licensing of this website’s content.</p><p>Site created by <a href="http://rexmac.com/">rexmac</a> and powered by <a href="http://jekyllrb.com/">Jekyll</a>, <a href="http://twitter.github.com/bootstrap/">Bootstrap</a>, and <a href="http://html5boilerplate.com/">H5BP</a>. Icons courtesy of <a href="http://fortawesome.github.com/Font-Awesome/">FontAwesome</a> by Dave Gandy. Social media badges courtesy of <a href="http://simekonelove.deviantart.com/#/d45qg9a">SimekOneLove</a>.</p><p>This site is proudly hosted on <a href="http://www.site5.com/in.php?id=23116">Site5</a> because they share their midi-chlorians.</p></div><div class="span4"><ul class="social-media-links"><li><a class="ir twitter" href="http://twitter.com/_rexmac" title="Follow me on Twitter">Follow me on Twitter</a></li><li><a class="ir gplus" href="http://google.com/+RexMcConnell" title="Follow me on Google+">Follow me on Google+</a></li><li><a class="ir github" href="http://github.com/" title="View my projects on Github">View my projects on GitHub</a></li><li><a class="ir stackoverflow" href="http://stackoverflow.com/users/624093/rexmac" title="View my StackOverflow profile">View my StackOverflow profile</a></li><li><a class="ir rss" href="http://rexmac.com/feed" title="nom nom?">RSS Feed</a></li></ul><a class="html5-logo pull-right" href="http://www.w3.org/html/logo/"><img src="http://www.w3.org/html/logo/badge/html5-badge-h-css3-graphics-semantics.png" width="197" height="64" alt="HTML5 Powered with CSS3 / Styling, Graphics, 3D &amp; Effects, and Semantics" title="HTML5 Powered with CSS3 / Styling, Graphics, 3D &amp; Effects, and Semantics" /></a></div></div></footer><p><a id="glider-tag-container" href="javascript:;" title="Pause life"><span id="glider-tag"><span class="dot"></span><span class="dot"></span><span class="dot"></span><span class="dot"></span><span class="dot"></span></span></a></p></div><script src="//ajax.googleapis.com/ajax/libs/jquery/1.9.0/jquery.min.js"></script><script>window.jQuery || document.write('<script src="/js/libs/jquery-1.9.0.min.js"><\/script>')</script><script src="/js/site.min.js?1511989715 "></script><!-- Whatchya lookin' at Willis?! --></body></html>